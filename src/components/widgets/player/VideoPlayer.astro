---
import Controls from "./controls/Controls.astro"
import Settings from "./settings/Settings.astro"
import CaptionSettings from "./settings/CaptionSettings.astro"

// assets
import TestVideo from "../../../assets/test.mp4"
import EngSub from "../../../assets/test-sub-en.vtt"
import TRSub from "../../../assets/test-sub-tr.vtt"
---

<div class="container">
	<div
		id="videoPlayer"
		aria-paused="true"
		transition:name="media-player"
		transition:persist
	>
		<video preload="metadata" id="mainVideo">
			<source src={TestVideo} type="video/mp4" />
			<source src={TestVideo} type="video/mp4" />
			<track
				id="englishSub"
				label="English"
				kind="subtitles"
				srclang="en"
				src={EngSub}
			/>
			<track
				id="turkishSub"
				label="Turkish"
				kind="subtitles"
				srclang="tr"
				src={TRSub}
			/>
		</video>

		<p class="sub-text" aria-caption-active="true"></p>

		<div class="progressAreaTime"></div>

		<Controls />

		<Settings />
		<CaptionSettings />
	</div>
</div>

<style lang="scss">
	.container {
		margin-top: 30px;

		display: flex;
		align-items: center;
		justify-content: center;

		position: relative;
		width: 100%;
		height: 100%;
	}

	#videoPlayer {
		position: relative;
		// width: 100%;
		width: 700px;
		height: 100%;

		overflow: hidden;
		border-radius: 5px;
		box-shadow: 0 0 5px rgba(255, 255, 255, 0.24);
		#mainVideo {
			position: relative;
			width: 100%;
			height: 100%;
			outline: none;
		}

		.progressAreaTime {
			--x: 7px;
			position: absolute;
			bottom: 60px;
			left: var(--x);
			padding: 4px 8px;
			color: #fff;
			font-size: 14px;
			background: #000;
			border-radius: 5px;
			z-index: 1;
			display: none;
		}

		.sub-text {
			position: absolute;
			left: 50%;
			bottom: 0;
			width: 90%;
			max-width: 90%;
			transform: translate(-50%, -50%);
			text-align: center;
			user-select: none;
			transition: bottom 0.3s;
			&[aria-caption-active="true"] {
				bottom: 10%;
			}
		}
	}
</style>

<script src="../../../scripts/player.ts"></script>
